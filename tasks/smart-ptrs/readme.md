# Smart Pointers

## Что за умные указатели такие?

Иногда объект, созданный на хипе, нужно передавать в кучу функций, методов, etc.
В такой ситуации становится сложно уследить за лайфтаймом объекта и моментом, 
когда нужно освобождать выделенную под объект память.

Хотелось бы воспользоваться удобной обёрткой,
которая автоматически выделит память при создании объекта
и освободит память, когда объект больше не используется --- 
ровно для этого и существуют умные указатели.

Умные указатели бывают разные. 
В рамках этого задания мы рассмотрим два типа, которые отличаются между собой 
семантикой владения:
* ```UniquePtr``` является единственным владельцем объекта.
* ```SharedPtr``` позволяет множественное владение.

## А делать что?

Глобально задание состоит из двух независимых компонент:
```UniquePtr``` и ```SharedPtr```.

### ```UniquePtr```

1. Basic, 2 балла, [тесты](unique_basic/test.cpp).
   * Реализовать базовую функциональность ```UniquePtr```.

2. Advanced, 2 балла, [тесты](unique_advanced/test.cpp). 
   * Добавить ```Deleter``` (функтор, который вызывается для объекта в 
   деструкторе указателя).
   * Интегрировать ```CompressedPair``` для ```Deleter```.
   * Специализировать шаблон для массивов --- ```UniquePtr<T[]>```.

### ```SharedPtr```

1. Basic, 3 балла, [тесты](shared_basic/test.cpp).
   * Реализовать базовую функциональность ```SharedPtr```.
   * Добавить оптимизированный ```MakeShared``` (одна аллокация на 
   контрольный блок и элемент).

2. Weak, 2 балла, [тесты](shared_weak/test.cpp).
   * Реализовать ```WeakPtr``` --- младшего брата ```SharedPtr```.

3. From This, 1 балл, [тесты](shared_from_this/test.cpp).
   * Реализовать ```EnableSharedFromThis``` --- способ создать ```SharedPtr```,
   имея лишь ```this```.

Всего баллов: 10.

В любой непонятной ситуации стоит начать с изучения тестов.

## Как решать и сдавать задачу?

* Весь код для ```SomePtr``` нужно держать в файле ```some.h```:

   | ```SomePtr``` | File |
   | --- | --- |
   | ```UniquePtr``` | [```unique.h```](unique.h) |
   | ```SharedPtr``` | [```shared.h```](shared.h) |
   | ```WeakPtr``` | [```weak.h```](weak.h) |

* Сдавать задачу надо из соответствующей директории, например `unique_basic` из директории `tasks/smart-ptrs/unique_basic`.
  
   Так как эта директория расположена на целых три уровня ниже корня репозитория (в котором лежит скрипт `submit.py`), то команда для сдачи будет выглядеть так:

```
python3 ../../../submit.py
```
